@using ResourceEntity
@model List<ResourceEntity.Models.Employee>

@{
	ViewData["Title"] = "Danh sách nhân viên";

}
@if (ViewBag.Msg != null)
{
	<div id="msgAlert" class="alert alert-success" style="position:absolute; z-index:10; top: 80px;
    left: 50%;
    transform: translate(-50%); " role="alert">
		<i class="fa fa-check"></i>
		@ViewBag.Msg
	</div>
}

<div class="col-lg-12 grid-margin stretch-card">
	<div class="card">
		<div class="card-header d-flex justify-content-between">
			<h4>@ViewData["Title"]</h4>
			@* <a class="btn btn-primary mr-1 justify-content-end" asp-controller="Employee" asp-action="RegisterEmployee">Thêm</a> *@
		</div>
		<div class="card-header">

			<form id="searchFilter" asp-action="ListEmployee" method="post" enctype="multipart/form-data">
				<div asp-validation-summary="All" class="text-danger"></div>
				<div class="row">
					<div class="col-12 col-md-3">
						<div class="form-group d-flex flex-column">
							<label class="control-label">Lọc theo phòng ban</label>
							<select id="title" class="search-employeeDepartment form-control" name="pb">
								<option value="All">All</option>
								@foreach (var item in ViewBag.SearchList)
								{
									if (item == ViewBag.SearchValue)
									{
										<option value="@item" selected="selected">@item</option>
									}
									else
									{
										<option value="@item">@item</option>
									}
								}
							</select>
						</div>
					</div>

					<div class="col-12 col-md-9 d-flex justify-content-between align-items-center">
						<input type="submit" value="Lọc" class="btn btn-primary" />

						<div>

							<a class="btn btn-primary mr-1 justify-content-end" asp-controller="Employee" asp-action="RegisterEmployee">Thêm</a>
						
							<a title="Xuất tất cả nhân sự" class="btn btn-success mr-1" asp-controller="Report" asp-action="PrintNhansu">Export</a>
						</div>

					</div>
				</div>

			</form>
		</div>
		<div class="card-body">
			<table id="table-employee" class="table table-striped mb-0" style="width:100%">
				<thead>
					<tr>
						<th class="align-middle" style="display:none">ID</th>
						<th class="align-middle">Avatar</th>
						<th class="align-middle">Tên nhân viên</th>
						<th class="align-middle">Liên hệ</th>
						@* 
						<th class="align-middle">Email</th>
						<th class="align-middle">Số điện thoại</th>
						<th class="align-middle">Địa chỉ</th> *@
						<th class="align-middle">CV</th>
						<th class="align-middle">Phòng ban</th>
						<th class="align-middle">Action</th>
					</tr>
				</thead>
				<tbody>

					@foreach (var employee in ViewBag.Employees)
					{
						<tr>
							<td style="display:none">
								@employee.EmployeeId
							</td>
							<td>
								<img src="/uploads/@employee.EmployeeAvatar" alt="@employee.EmployeeName" width="100" height="100" onerror="this.onerror=null; this.src='/uploads/logo_002d.png';">
							</td>
							<td>
								@employee.EmployeeName
							</td>
							<td>
								<p style="line-height:1.5">
									<b>Địa chỉ: </b>@employee.EmployeeAddress <br/>
									<b>Sđt: </b> @employee.EmployeePhone<br />
									<b>Email: </b> @employee.EmployeeEmail
								</p>
							
							</td>
							@* <td>
								@employee.EmployeeAddress
							</td>
							<td>
								@employee.EmployeePhone
							</td>
							<td>
								@employee.EmployeeEmail
							</td> *@
							<td>
								<a href="/uploads/@employee.EmployeeCv"><i class="fa fa-file-pdf-o"></i></a>
							</td>
							<td>
								@employee.EmployeeDepartment
							</td>
							<td>
								<a class="mr-2" href="@Url.Action("Edit", "Employee",new { id = employee.EmployeeId })" title="Chỉnh sửa">
									<i class="fa fa-edit text-success mr-2" style="font-size:larger"></i>
								</a>
								@* <a href="@Url.Action("DeleteEmp", "Employee",new { id = employee.EmployeeId })" title="Xóa">
							<i class="fa fa-trash-o text-danger" style="font-size:larger"></i>
							</a> *@
								<a style="cursor:pointer"
							   title="Xóa"
							   data-toggle="Delete-modal-emp"
							   data-target="#DeleteEmp"
							   data-url="@Url.Action("DeleteEmpModal","Employee", new { id = employee.EmployeeId })">
									<i class="fa fa-trash-o text-danger" style="font-size:larger"></i>
								</a>
							</td>
						</tr>
					}


				</tbody>
			</table>

		</div>
	</div>
</div>



<div id="DeleteModalEmployee"></div>
@await Html.PartialAsync("_DataTableScripts")
@* @section Scripts { *@

<script>
	$('.search-employeeDepartment').select2({
		placeholder: "Ex: HPT"
	});
	setTimeout(function () {
		$('#msgAlert').fadeOut("slow");
	}, 2000)

	var table = $('#table-employee').DataTable({
		scrollX: true,
	});
	table
		.order([0, 'desc'])
		.draw();
</script>
@* } *@